\hypertarget{_texture_8h_source}{}\doxysection{Texture.\+h}
\label{_texture_8h_source}\index{D:/Repositories/Space Engine/SpaceGame/include/renderer/Texture.h@{D:/Repositories/Space Engine/SpaceGame/include/renderer/Texture.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include "{}GLClasses.h"{}}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}stb/stb\_image.h"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}stb/stb\_image\_write.h"{}}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}renderer/Vertex.hpp"{}}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{keyword}{namespace }Tex}
\DoxyCodeLine{9 \{}
\DoxyCodeLine{10     \textcolor{keyword}{class }\mbox{\hyperlink{class_tex_1_1_texture}{Texture}}}
\DoxyCodeLine{11     \{}
\DoxyCodeLine{12     \textcolor{keyword}{public}:}
\DoxyCodeLine{13         \mbox{\hyperlink{class_tex_1_1_texture}{Texture}}() : m\_ID(0), m\_FilePath(\textcolor{stringliteral}{"{}res/debug.png"{}}), m\_LocalBuffer(\textcolor{keyword}{nullptr}), m\_Width(0), m\_Height(0), m\_BPP(0) \{\};}
\DoxyCodeLine{14         \mbox{\hyperlink{class_tex_1_1_texture}{\string~Texture}}();}
\DoxyCodeLine{15 }
\DoxyCodeLine{19         \textcolor{keywordtype}{void} \mbox{\hyperlink{class_tex_1_1_texture_adf1cbc6f5f37b4f83e0b49615b3b988e}{loadTexture}}(\textcolor{keyword}{const} std::string\& path);}
\DoxyCodeLine{23         \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_tex_1_1_texture_a93fa8b77e0301d4957f0f57e4f4e747f}{loadTexture}}(\textcolor{keyword}{const} std::string\& path, \textcolor{keywordtype}{bool} flip);}
\DoxyCodeLine{27         \textcolor{keywordtype}{void} \mbox{\hyperlink{class_tex_1_1_texture_ad85d6f1df867355a3ae44a8d3975420f}{generateTexture}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} slot);}
\DoxyCodeLine{31         \textcolor{keywordtype}{void} \mbox{\hyperlink{class_tex_1_1_texture_af748e1aec4f2dc0f9817712839316a8f}{generateTexture}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} slot, \textcolor{keywordtype}{void}* buffer);}
\DoxyCodeLine{35         \textcolor{keywordtype}{void} \mbox{\hyperlink{class_tex_1_1_texture_a3eb130e7ac7a98c6ea39e2a2b16aee01}{generateTextureWrap}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} slot, \textcolor{keywordtype}{void}* buffer); \textcolor{comment}{//TODO have 1 func}}
\DoxyCodeLine{36         \textcolor{keywordtype}{void} bind() \textcolor{keyword}{const};}
\DoxyCodeLine{37         \textcolor{keywordtype}{void} unbind() \textcolor{keyword}{const};}
\DoxyCodeLine{41         \textcolor{keywordtype}{void} \mbox{\hyperlink{class_tex_1_1_texture_a8a0da25af18e472646c94718c31d2b99}{clearBuffer}}();}
\DoxyCodeLine{42 }
\DoxyCodeLine{46         \textcolor{keywordtype}{void} \mbox{\hyperlink{class_tex_1_1_texture_a17454e8a78cd4e2fbb4ea57bedb8a8b4}{deleteTexture}}()\textcolor{keyword}{ const }\{ glDeleteTextures(1, \&m\_ID); \}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} getID()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_ID; \}}
\DoxyCodeLine{49 }
\DoxyCodeLine{50         \textcolor{keywordtype}{void} setWidth(\textcolor{keywordtype}{int} width) \{ m\_Width = width; \}}
\DoxyCodeLine{51         \textcolor{keywordtype}{void} setHeight(\textcolor{keywordtype}{int} height) \{ m\_Height = height; \}}
\DoxyCodeLine{52         \textcolor{keywordtype}{void} setBPP(\textcolor{keywordtype}{int} bpp) \{ m\_BPP = bpp; \}}
\DoxyCodeLine{53         \textcolor{keywordtype}{int} width()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_Width; \}}
\DoxyCodeLine{54         \textcolor{keywordtype}{int} height()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_Height; \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56     \textcolor{keyword}{private}:}
\DoxyCodeLine{57         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m\_ID; \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m\_Slot = 0;}
\DoxyCodeLine{58         std::string m\_FilePath;}
\DoxyCodeLine{59         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}* m\_LocalBuffer = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{60         \textcolor{keywordtype}{int} m\_Width, m\_Height, m\_BPP;}
\DoxyCodeLine{61 }
\DoxyCodeLine{62     \};}
\DoxyCodeLine{63 }
\DoxyCodeLine{64     \textcolor{keyword}{struct }\textcolor{keyword}{alignas}(1) \mbox{\hyperlink{struct_tex_1_1_tex_channel__4}{TexChannel\_4}}}
\DoxyCodeLine{65     \{}
\DoxyCodeLine{66         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} r;}
\DoxyCodeLine{67         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} g;}
\DoxyCodeLine{68         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} b;}
\DoxyCodeLine{69         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} a;}
\DoxyCodeLine{70     \};}
\DoxyCodeLine{71 }
\DoxyCodeLine{72     \textcolor{keyword}{struct }\textcolor{keyword}{alignas}(1) \mbox{\hyperlink{struct_tex_1_1_tex_channel__3}{TexChannel\_3}}}
\DoxyCodeLine{73     \{}
\DoxyCodeLine{74         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} r;}
\DoxyCodeLine{75         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} g;}
\DoxyCodeLine{76         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} b;}
\DoxyCodeLine{77     \};}
\DoxyCodeLine{78 }
\DoxyCodeLine{79     \textcolor{keyword}{struct }\mbox{\hyperlink{struct_tex_1_1_tex_buffer}{TexBuffer}}}
\DoxyCodeLine{80     \{}
\DoxyCodeLine{81         \textcolor{keywordtype}{int} width;}
\DoxyCodeLine{82         \textcolor{keywordtype}{int} height;}
\DoxyCodeLine{83         \textcolor{keywordtype}{int} bpp;}
\DoxyCodeLine{84         \mbox{\hyperlink{struct_tex_1_1_tex_channel__4}{TexChannel\_4}}* buffer = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{85         std::string name;}
\DoxyCodeLine{86     \};}
\DoxyCodeLine{87 }
\DoxyCodeLine{88     \textcolor{keyword}{struct }\mbox{\hyperlink{struct_tex_1_1_u_v_transform}{UVTransform}}}
\DoxyCodeLine{89     \{}
\DoxyCodeLine{90         \textcolor{keywordtype}{float} deltaV;}
\DoxyCodeLine{91         \textcolor{keywordtype}{float} scaleU; \textcolor{keywordtype}{float} scaleV;}
\DoxyCodeLine{92     \};}
\DoxyCodeLine{93 }
\DoxyCodeLine{94     \textcolor{keyword}{class }\mbox{\hyperlink{class_tex_1_1_texture_atlas_r_g_b_a}{TextureAtlasRGBA}}}
\DoxyCodeLine{95     \{}
\DoxyCodeLine{96     \textcolor{keyword}{public}:}
\DoxyCodeLine{97         \mbox{\hyperlink{class_tex_1_1_texture_atlas_r_g_b_a}{TextureAtlasRGBA}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{98         \mbox{\hyperlink{class_tex_1_1_texture_atlas_r_g_b_a}{\string~TextureAtlasRGBA}}() \{ clearBuffers(); deleteTextures(); \};}
\DoxyCodeLine{99         \textcolor{keywordtype}{void} loadTexture(\textcolor{keyword}{const} std::string\& path, \textcolor{keyword}{const} std::string\& name);}
\DoxyCodeLine{100         \textcolor{keywordtype}{void} generateAtlas();}
\DoxyCodeLine{101         \textcolor{keywordtype}{void} generateTexture(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} slot);}
\DoxyCodeLine{102         \textcolor{keywordtype}{void} clearBuffers();}
\DoxyCodeLine{103         \textcolor{keywordtype}{void} clearTextureBuffers();}
\DoxyCodeLine{104         \textcolor{keywordtype}{void} clearAtlasBuffers();}
\DoxyCodeLine{105         \textcolor{keywordtype}{void} deleteTextures()\textcolor{keyword}{ const }\{ glDeleteTextures(1, \&m\_ID); \}}
\DoxyCodeLine{106         \textcolor{keywordtype}{void} requestNewTextures() \{ m\_RequestNewTextures = \textcolor{keyword}{true}; clearBuffers(); \}}
\DoxyCodeLine{107         \textcolor{keywordtype}{bool} shouldRequestNewTextures()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_RequestNewTextures; \}}
\DoxyCodeLine{108 }
\DoxyCodeLine{109         \textcolor{keywordtype}{void} bind()\textcolor{keyword}{ const }\{ glActiveTexture(GL\_TEXTURE0 + m\_Slot); glBindTexture(GL\_TEXTURE\_2D, m\_ID); \}}
\DoxyCodeLine{110         \textcolor{keywordtype}{void} unbind()\textcolor{keyword}{ const }\{glActiveTexture(GL\_TEXTURE0 + m\_Slot); glBindTexture(GL\_TEXTURE\_2D, 0);\}}
\DoxyCodeLine{111 }
\DoxyCodeLine{112         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} currentTextureCycle() \{ \textcolor{keywordflow}{return} m\_AtlasGenCycle; \}}
\DoxyCodeLine{113 }
\DoxyCodeLine{114         \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{115         \mbox{\hyperlink{struct_tex_1_1_u_v_transform}{UVTransform}} mapModelVerts(T* vertices, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} vertCount, std::string texName)}
\DoxyCodeLine{116         \{}
\DoxyCodeLine{117             \textcolor{keyword}{static\_assert}(std::is\_base\_of<SGRender::TVertex, T>::value, \textcolor{stringliteral}{"{}Must be a texture vertex!"{}});}
\DoxyCodeLine{118             }
\DoxyCodeLine{119             \textcolor{keywordflow}{if} (m\_AtlasRequest.find(texName) == m\_AtlasRequest.end())}
\DoxyCodeLine{120             \{}
\DoxyCodeLine{121                 EngineLog(\textcolor{stringliteral}{"{}Requested texture is not in atlas! "{}}, texName);}
\DoxyCodeLine{122                 \textcolor{keywordflow}{return} \{ 0.0f, 0.0f, 0.0f \};}
\DoxyCodeLine{123             \}}
\DoxyCodeLine{124             \mbox{\hyperlink{struct_tex_1_1_u_v_transform}{UVTransform}} trans = m\_AtlasRequest.at(texName);}
\DoxyCodeLine{125             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < vertCount; i++)}
\DoxyCodeLine{126             \{}
\DoxyCodeLine{127                 vertices[i].uvCoords.x *= trans.scaleU;}
\DoxyCodeLine{128                 vertices[i].uvCoords.y *= trans.scaleV;}
\DoxyCodeLine{129                 vertices[i].uvCoords.y += trans.deltaV;}
\DoxyCodeLine{130             \}}
\DoxyCodeLine{131             \textcolor{keywordflow}{return} trans;}
\DoxyCodeLine{132         \}}
\DoxyCodeLine{133 }
\DoxyCodeLine{134         \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{135         \textcolor{keyword}{static} \textcolor{keywordtype}{void} unmapModelVerts(T* vertices, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} vertCount, std::string texName, \mbox{\hyperlink{struct_tex_1_1_u_v_transform}{UVTransform}} trans)}
\DoxyCodeLine{136         \{}
\DoxyCodeLine{137             \textcolor{keyword}{static\_assert}(std::is\_base\_of<SGRender::TVertex, T>::value, \textcolor{stringliteral}{"{}Must be a texture vertex!"{}});}
\DoxyCodeLine{138             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < vertCount; i++)}
\DoxyCodeLine{139             \{}
\DoxyCodeLine{140                 vertices[i].uvCoords.y -\/= trans.deltaV;}
\DoxyCodeLine{141                 vertices[i].uvCoords.x /= trans.scaleU;}
\DoxyCodeLine{142                 vertices[i].uvCoords.y /= trans.scaleV;}
\DoxyCodeLine{143             \}}
\DoxyCodeLine{144         \}}
\DoxyCodeLine{145 }
\DoxyCodeLine{146     \textcolor{keyword}{private}:}
\DoxyCodeLine{147         std::vector<TexBuffer> m\_LocalBuffers;}
\DoxyCodeLine{148         \mbox{\hyperlink{struct_tex_1_1_tex_channel__4}{TexChannel\_4}}* m\_AtlasBuffer = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{149         std::unordered\_map<std::string, UVTransform> m\_AtlasRequest;}
\DoxyCodeLine{150         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m\_Slot; \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m\_ID;}
\DoxyCodeLine{151         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m\_Width; \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m\_Height;}
\DoxyCodeLine{152         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} m\_AtlasGenCycle = 0; \textcolor{comment}{//Goes up each time a new texture is generated -\/ should let models know to remap}}
\DoxyCodeLine{153         \textcolor{keywordtype}{bool} m\_RequestNewTextures = \textcolor{keyword}{false}; \textcolor{comment}{//Checks whether objects linked to atlas should load their textures again -\/ means only textures in buffer should be textures needed}}
\DoxyCodeLine{154     \};}
\DoxyCodeLine{155 \}}

\end{DoxyCode}
